# CafeteriaFlow
  **Командный кейс № 2 «Управление столовой»**

## Описание проекта:
  Веб-приложение для автоматизации школьной столовой, позволяющее ученикам просматривать меню, формировать заказы, управлять аллергенами и оставлять отзывы. Приложение поддерживает три роли пользователей: ученик, повар и администратор.

## Основные возможности:

  ### Для учеников:
  - Просмотр меню с фильтрацией по аллергенам
  - Добавление блюд в корзину и удаление их
  - Пополнение баланса и покупка абонементов
  - Оставление отзывов
  - Просмотр истории заказов
  - Управление списком аллергенов
  - Разделение меню на завтраки и обеды

  ### Для поваров:
  - Просмотр заказов для приготовления
  - Подача заявок на закупку продуктов
  - Управление выдачей блюд

  ### Для администраторов:
  - Управление системой (административная панель)

## Обоснование выбора технологий:

  ### Python + Flask:
  **Почему выбрали:**
  - **Python** - простой, понятный нам синтаксис, богатая экосистема библиотек
  - **Flask** - легковесный фреймворк, идеально подходит для небольших веб-приложений

  ### SQLite:
  **Почему выбрали:**
  - **Простота** - не требует отдельного сервера БД
  - **Файловая система** - все данные в одном файле, легко переносить

  ### HTML/CSS:
  **Почему выбрали:**
  - **Минимальные требования** - соответствует условиям задачи
  - **Простота поддержки** - не требуется компиляция или сборка
  - **Быстрая отдача** - можно сразу видеть результаты
  - **Достаточно для функциональности** - все требования ТЗ можно выполнить

## Дизайн и стили:
  ### Цветовая палитра:
  - **Основной фон**: #f2e9e4 (светлый бежевый)
  - **Хедер**: #4a4e69 (темно-синий)
  - **Карточки**: #c9ada7 (розовато-бежевый)
  - **Текст**: #22223b (темно-синий)
  - **Акценты**: #4a4e69, #9a8c98

  ### Шрифты:
  - **Основной**: Nunito (Google Fonts)
  - **Насыщенный**: 200-1000 weight range

## Интерфейс:

  ### Основные страницы:
  - Главная страница - сетка блюд с разделением на завтраки и обеды
  - Корзина - просмотр выбранных блюд с общей суммой
  - Профиль - баланс, история заказов, управление аллергенами
  - Отзывы - просмотр и добавление отзывов
  - Пополнение счета - пополнение баланса и покупка абонемента

## Для запуска программы требуются:

  ### Backend:
  - **Python 3.8+**
  - **Flask 3.1.2** - веб-фреймворк
  - **SQLAlchemy 2.0.45** - ORM для работы с базой данных
  - **Flask-Login** - аутентификация пользователей
  - **Flask-WTF** - работа с формами
  - **Werkzeug** - безопасность (хэширование паролей)

  ### База данных:
  - **SQLite** - файловая база данных

## Структура проекта:
  dataalchemy/  
  ├── models/                    # Модели SQLAlchemy  
  │   ├── __init__.py            # Экспорт моделей  
  │   ├── allergens.py           # Аллергены и связи с пользователями  
  │   ├── bascket.py             # Корзина покупок  
  │   ├── base.py                # Базовый класс моделей  
  │   ├── dish_food.py           # Связь блюда-продукты  
  │   ├── dishes.py              # Блюда (базовые, завтраки, обеды)  
  │   ├── food.py                # Продукты/ингредиенты  
  │   ├── history.py             # История заказов  
  │   ├── purchase_request.py    # Заявки на закупку  
  │   ├── reviews.py             # Отзывы  
  │   └── users.py               # Пользователи (ученики, повара, админы)  
  │  
  ├── __init__.py                # Инициализация пакета dataalchemy  
  ├── db_engine.py               # Настройка движка БД (SQLite)  
  └── db_session.py              # Управление сессиями БД  
  
  database/  
  └── school.db                  # База данных со всей информацией  
    
  forms/                         # WTForms формы  
  ├── alergen_add.py             # Форма добавления аллергенов  
  ├── bascketform.py             # Форма корзины  
  ├── cook_dashboard.py          # Форма панели повара  
  ├── first_page.py              # Форма главной страницы  
  ├── login.py                   # Форма входа  
  ├── new_reviews.py             # Форма нового отзыва  
  ├── profile.py                 # Форма профиля  
  ├── register.py                # Форма регистрации  
  ├── reviews.py                 # Форма отзывов  
  └── top_up_acc.py              # Форма пополнения счета  
    
  static/                        # Статические файлы  
  ├── images/                    # Изображения  
  │   ├── logo.png  
  │   ├── no_image.jpg  
  │   ├── breakfast/             # Папка с изображениями завтраков  
  │   └── lunch/                 # Папка с изображениями обедов  
  │  
  ├── admin_dashboard.css        # Стиль для admin_dashboard.html  
  ├── alergen_add.css            # Стиль для alergen_add.html  
  ├── bascket.css                # Стиль для bascket.html  
  ├── cook_dashboard.css         # Стиль для cook_dashboard.html  
  ├── first_page.css             # Стиль для first_page.html  
  ├── Log_in.css                 # Стиль для log_in.html  
  ├── new_reviews.css            # Стиль для new_reviews.html  
  ├── profile.css                # Стиль для profile.html  
  ├── registration.css           # Стиль для registration.html  
  ├── reviews.css                # Стиль для reviews.html  
  └── top_up_acc.css             # Стиль для top_up_acc.html  
    
  templates/                     # HTML шаблоны  
  ├── admin_dashboard.html  
  ├── alergen_add.html  
  ├── bascket.html  
  ├── cook_dashboard.html  
  ├── first_page.html  
  ├── log_in.html  
  ├── new_reviews.html  
  ├── profile.html  
  ├── registration.html  
  ├── reviews.html  
  └── top_up_acc.html  
  
  default_menu.py              # Стандартное меню блюд  
  main.py                      # Основное Flask-приложение  
  requirements.txt             # Зависимости Python  

## Модели базы данных

  ### Основные сущности:
  - **User** - пользователи (ученики, повара, админы)
  - **Dish** - блюда (с полиморфизмом на BreakfastDish и LunchDish)
  - **Allergen** - аллергены
  - **Bascket** - корзина покупок
  - **Review** - отзывы
  - **History** - история заказов
  - **PurchaseRequest** - заявки на закупку

  ### Связи:
  - **User** ↔ **Allergen** - аллергены пользователя
  - **User** → **Bascket** - корзина пользователя
  - **User** → **Review** - отзывы пользователя
  - **User** → **History** - история заказов

## Инициализация данных:

  ### При первом запуске автоматически создаются:
  - База данных с таблицами
  - Два основных аллергена: lactose (лактоза) и eggs (яйца)
  - Стандартное меню из 21 блюда
  - Учетные записи администратора и повара

## Доступы по умолчанию:

  ### Администратор:
  - Логин: sosok@school.ru  
  - Пароль: admin_god
  - Роль: Администратор (role_id=3)

  ### Повар:
  - Логин: cook@school.ru
  - Пароль: cook123
  - Роль: Повар (role_id=2)

  ### Ученики:
  - Могут зарегистрироваться самостоятельно через форму регистрации
  - Роль по умолчанию: Ученик (role_id=1)

## Уровни доступа:

  - Ученик (role_id=1) - базовый доступ
  - Повар (role_id=2) - доступ к заказам и заявкам на закупку
  - Администратор (role_id=3) - полный доступ ко всем функциям

## Особенности реализации:

  ### Полиморфизм моделей:
  - Dish имеет подклассы BreakfastDish и LunchDish
  - User имеет подклассы RoleAdmin и RoleCook

  ### Фильтрация по аллергенам:
  - Автоматическое исключение блюд с аллергенами пользователя
  - Возможность управления списком аллергенов

  ### Абонементы:
  - Месячный абонемент за 3000 рублей
  - Пользователи с активным абонементом получают блюда бесплатно
  - Автопродление при повторной покупке

  ### Безопасность:
  - Хэширование паролей через werkzeug.security
  - Защита от CSRF через Flask-WTF
  - Аутентификация через Flask-Login
